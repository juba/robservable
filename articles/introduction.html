<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to robservable • robservable</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to robservable">
<meta property="og:description" content="robservable">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">robservable</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to robservable</a>
    </li>
    <li>
      <a href="../articles/gallery.html">robservable Gallery</a>
    </li>
    <li>
      <a href="../articles/shiny.html">robservable in Shiny applications</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/juba/robservable/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="introduction_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="introduction_files/robservable-binding-0.2.0.9000/robservable.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to robservable</h1>
                        <h4 class="author">Julien Barnier, Kenton Russell</h4>
            
            <h4 class="date">2021-09-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/juba/robservable/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p><code>robservable</code> allows the use of <a href="https://observablehq.com/">Observable</a> notebooks (or part of them) as <a href="http://www.htmlwidgets.org/">htmlwidgets</a> in R.</p>
<p>Note that it is not just an <code>iframe</code> embedding a whole notebook. Cells are integrated directly into the document or application with no <code>iframe</code> wrapper. You can choose what cells to display, update cell values from R, and add observers to cells to get their values back into a Shiny application.</p>
<div id="embed-a-whole-notebook" class="section level2">
<h2 class="hasAnchor">
<a href="#embed-a-whole-notebook" class="anchor"></a>Embed a whole notebook</h2>
<p>The most basic usage is to call the <code><a href="../reference/robservable.html">robservable()</a></code> function with the full URL or the identifier of the notebook you want to display. The identifier is the same as the one used to import another notebook in Observable (something like <code>@d3/horizontal-bar-chart</code>). Please see the <a href="https://observablehq.com/@observablehq/introduction-to-imports">Introduction to Imports</a> notebook for additional reference.</p>
<p>For example, the two following commands are equivalent and should display the whole corresponding notebook<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> :</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span><span class="st">"https://observablehq.com/@d3/horizontal-bar-chart"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span><span class="st">"@d3/horizontal-bar-chart"</span><span class="op">)</span></code></pre></div>
<p>If the notebook is shared but not published, you can use the full URL or the hash identifier.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span><span class="st">"https://observablehq.com/d/61be71d2b8c0d456"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span><span class="st">"61be71d2b8c0d456"</span><span class="op">)</span></code></pre></div>
</div>
<div id="choose-which-cells-to-render" class="section level2">
<h2 class="hasAnchor">
<a href="#choose-which-cells-to-render" class="anchor"></a>Choose which cells to render</h2>
<p>Instead of rendering a whole notebook, we can choose to display only some of its cells. This is done by passing a character vector of cell names to the <code>include</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@d3/horizontal-bar-chart"</span>, 
  include <span class="op">=</span> <span class="st">"chart"</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-3d49a961dad5459e32e8" style="width:700px;height:432.632880098888px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-3d49a961dad5459e32e8">{"x":{"notebook":"@d3/horizontal-bar-chart","include":"chart","hide":null,"input":null,"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p>If you need to display an unnamed cell<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, you can do it by specifying its number, <em>ie</em> its position in the notebook (starting with 1). For example, to display the first cell of a notebook if it is unnamed you would use <code>include = 1</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@d3/horizontal-bar-chart"</span>, 
  include <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
<p>Note that specifying a named cell by its position will <em>not</em> display it. You have to add its name to <code>include</code>.</p>
<p>For some notebooks you’ll have to render several cells to get the desired result. For example, in the <a href="https://observablehq.com/@mbostock/eyes">eyes notebook</a>, the main chart is in a cell named <code>canvas</code>, but it doesn’t render anything if <code>mouse</code> value is not present. For the chart to be created, you have to render both cells.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@mbostock/eyes"</span>,
  include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"canvas"</span>, <span class="st">"mouse"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-18084920dbe4504934e5" style="width:700px;height:432.632880098888px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-18084920dbe4504934e5">{"x":{"notebook":"@mbostock/eyes","include":["canvas","mouse"],"hide":null,"input":null,"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p style="height:30px;">
</p>
<p>In this case, we may want to render <code>mouse</code> without displaying it. This is possible by adding its name to the <code>hide</code> argument.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@mbostock/eyes"</span>,
  include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"canvas"</span>, <span class="st">"mouse"</span><span class="op">)</span>,
  hide <span class="op">=</span> <span class="st">"mouse"</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-ca828900d15bc95d8b8b" style="width:700px;height:432.632880098888px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-ca828900d15bc95d8b8b">{"x":{"notebook":"@mbostock/eyes","include":["canvas","mouse"],"hide":"mouse","input":null,"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p>Finally, it is possible to mix the use of named and unnamed cells both in <code>cell</code> and <code>hide</code>, so you can do something like below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@mbostock/eyes"</span>,
  include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"canvas"</span>, <span class="st">"mouse"</span><span class="op">)</span>,
  hide <span class="op">=</span> <span class="st">"mouse"</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="update-cell-values" class="section level2">
<h2 class="hasAnchor">
<a href="#update-cell-values" class="anchor"></a>Update cell values</h2>
<p><code>robservable</code> allows to update a notebook cell value directly from R. This is done by passing a named list as the <code>input</code> argument.</p>
<p>For example, in the horizontal bar chart notebook there is a cell called <code>barHeight</code> which allows to customize the bar heights. We can modify its value when calling <code>robservable</code> with <code>input = list(barHeight = 15)</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@d3/horizontal-bar-chart"</span>, 
  include <span class="op">=</span> <span class="st">"chart"</span>,
  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>barHeight <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-ed9cffff3f9234bffa10" style="width:700px;height:432.632880098888px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed9cffff3f9234bffa10">{"x":{"notebook":"@d3/horizontal-bar-chart","include":"chart","hide":null,"input":{"barHeight":15},"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p>More interesting, we can update the <code>data</code> cell value of the notebook to generate the bar chart based on our own data. We just have to be sure that it is in the same format as the notebook data. In this example the data is in a standard <code>d3-array</code> format, so we can pass a data frame. We will need to take care of the column names, as they must match the ones in the notebook data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">species</span><span class="op">)</span><span class="op">)</span>
<span class="co"># change column names to match the names used in the observable notebook</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"value"</span><span class="op">)</span>

<span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@d3/horizontal-bar-chart"</span>, 
  include <span class="op">=</span> <span class="st">"chart"</span>,
  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-10e1f24bceaeb0a61355" style="width:700px;height:432.632880098888px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-10e1f24bceaeb0a61355">{"x":{"notebook":"@d3/horizontal-bar-chart","include":"chart","hide":null,"input":{"data":[{"name":"Adelie","value":152},{"name":"Chinstrap","value":68},{"name":"Gentoo","value":124}]},"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p>There’s still one problem though. Our species names are truncated. We can fix this because the notebook allows us to change the margins of the plot by modifiying the <code>margin</code> cell. As this cell value is a JavaScript object, we can update it by passing a named <code>list</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@d3/horizontal-bar-chart"</span>,
  include <span class="op">=</span> <span class="st">"chart"</span>,
  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">df</span>,
    <span class="co"># equivalent to {top: 20, right: 0, left: 70, bottom: 0} in JavaScript</span>
    margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>top <span class="op">=</span> <span class="fl">20</span>, right <span class="op">=</span> <span class="fl">0</span>, left <span class="op">=</span> <span class="fl">70</span>, bottom <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-15c2aa4642fa3cf67e0d" style="width:700px;height:432.632880098888px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-15c2aa4642fa3cf67e0d">{"x":{"notebook":"@d3/horizontal-bar-chart","include":"chart","hide":null,"input":{"data":[{"name":"Adelie","value":152},{"name":"Chinstrap","value":68},{"name":"Gentoo","value":124}],"margin":{"top":20,"right":0,"left":70,"bottom":0}},"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p>Finally, here is a bit more complex example which displays a <a href="https://observablehq.com/@d3/multi-line-chart">multi-line chart</a> with the <code>gapminder</code> data. The <code>to_js_date</code> function is a helper to convert <code>Date</code> or <code>POSIXt</code> R objects to JavaScript <code>Date</code> values (<em>ie</em> number of milliseconds since Unix Epoch).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jennybc/gapminder">gapminder</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span>
<span class="va">series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">country</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">values</span> <span class="op">&lt;-</span> <span class="va">gapminder</span><span class="op">[</span><span class="va">gapminder</span><span class="op">$</span><span class="va">country</span> <span class="op">==</span> <span class="va">country</span>, <span class="st">"lifeExp"</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">country</span>, values <span class="op">=</span> <span class="va">values</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>
<span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="st">"Life expectancy"</span>,
  series <span class="op">=</span> <span class="va">series</span>,
  dates <span class="op">=</span> <span class="fu"><a href="../reference/to_js_date.html">to_js_date</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@d3/multi-line-chart"</span>,
  include <span class="op">=</span> <span class="st">"chart"</span>,
  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-bc2670760cd2f2181134" style="width:700px;height:432.632880098888px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-bc2670760cd2f2181134">{"x":{"notebook":"@d3/multi-line-chart","include":"chart","hide":null,"input":{"data":{"y":"Life expectancy","series":[{"name":"Afghanistan","values":[28.801,30.332,31.997,34.02,36.088,38.438,39.854,40.822,41.674,41.763,42.129,43.828]},{"name":"Albania","values":[55.23,59.28,64.82,66.22,67.69,68.93,70.42,72,71.581,72.95,75.651,76.423]},{"name":"Algeria","values":[43.077,45.685,48.303,51.407,54.518,58.014,61.368,65.799,67.744,69.152,70.994,72.301]},{"name":"Angola","values":[30.015,31.999,34,35.985,37.928,39.483,39.942,39.906,40.647,40.963,41.003,42.731]},{"name":"Argentina","values":[62.485,64.399,65.142,65.634,67.065,68.481,69.942,70.774,71.868,73.275,74.34,75.32]},{"name":"Australia","values":[69.12,70.33,70.93,71.1,71.93,73.49,74.74,76.32,77.56,78.83,80.37,81.235]},{"name":"Austria","values":[66.8,67.48,69.54,70.14,70.63,72.17,73.18,74.94,76.04,77.51,78.98,79.829]},{"name":"Bahrain","values":[50.939,53.832,56.923,59.923,63.3,65.593,69.052,70.75,72.601,73.925,74.795,75.635]},{"name":"Bangladesh","values":[37.484,39.348,41.216,43.453,45.252,46.923,50.009,52.819,56.018,59.412,62.013,64.062]},{"name":"Belgium","values":[68,69.24,70.25,70.94,71.44,72.8,73.93,75.35,76.46,77.53,78.32,79.441]},{"name":"Benin","values":[38.223,40.358,42.618,44.885,47.014,49.19,50.904,52.337,53.919,54.777,54.406,56.728]},{"name":"Bolivia","values":[40.414,41.89,43.428,45.032,46.714,50.023,53.859,57.251,59.957,62.05,63.883,65.554]},{"name":"Bosnia and Herzegovina","values":[53.82,58.45,61.93,64.79,67.45,69.86,70.69,71.14,72.178,73.244,74.09,74.852]},{"name":"Botswana","values":[47.622,49.618,51.52,53.298,56.024,59.319,61.484,63.622,62.745,52.556,46.634,50.728]},{"name":"Brazil","values":[50.917,53.285,55.665,57.632,59.504,61.489,63.336,65.205,67.057,69.388,71.006,72.39]},{"name":"Bulgaria","values":[59.6,66.61,69.51,70.42,70.9,70.81,71.08,71.34,71.19,70.32,72.14,73.005]},{"name":"Burkina Faso","values":[31.975,34.906,37.814,40.697,43.591,46.137,48.122,49.557,50.26,50.324,50.65,52.295]},{"name":"Burundi","values":[39.031,40.533,42.045,43.548,44.057,45.91,47.471,48.211,44.736,45.326,47.36,49.58]},{"name":"Cambodia","values":[39.417,41.366,43.415,45.415,40.317,31.22,50.957,53.914,55.803,56.534,56.752,59.723]},{"name":"Cameroon","values":[38.523,40.428,42.643,44.799,47.049,49.355,52.961,54.985,54.314,52.199,49.856,50.43]},{"name":"Canada","values":[68.75,69.96,71.3,72.13,72.88,74.21,75.76,76.86,77.95,78.61,79.77,80.653]},{"name":"Central African Republic","values":[35.463,37.464,39.475,41.478,43.457,46.775,48.295,50.485,49.396,46.066,43.308,44.741]},{"name":"Chad","values":[38.092,39.881,41.716,43.601,45.569,47.383,49.517,51.051,51.724,51.573,50.525,50.651]},{"name":"Chile","values":[54.745,56.074,57.924,60.523,63.441,67.052,70.565,72.492,74.126,75.816,77.86,78.553]},{"name":"China","values":[44,50.54896,44.50136,58.38112,63.11888,63.96736,65.525,67.274,68.69,70.426,72.028,72.961]},{"name":"Colombia","values":[50.643,55.118,57.863,59.963,61.623,63.837,66.653,67.768,68.421,70.313,71.682,72.889]},{"name":"Comoros","values":[40.715,42.46,44.467,46.472,48.944,50.939,52.933,54.926,57.939,60.66,62.974,65.152]},{"name":"Congo, Dem. Rep.","values":[39.143,40.652,42.122,44.056,45.989,47.804,47.784,47.412,45.548,42.587,44.966,46.462]},{"name":"Congo, Rep.","values":[42.111,45.053,48.435,52.04,54.907,55.625,56.695,57.47,56.433,52.962,52.97,55.322]},{"name":"Costa Rica","values":[57.206,60.026,62.842,65.424,67.849,70.75,73.45,74.752,75.713,77.26,78.123,78.782]},{"name":"Cote d'Ivoire","values":[40.477,42.469,44.93,47.35,49.801,52.374,53.983,54.655,52.044,47.991,46.832,48.328]},{"name":"Croatia","values":[61.21,64.77,67.13,68.5,69.61,70.64,70.46,71.52,72.527,73.68,74.876,75.748]},{"name":"Cuba","values":[59.421,62.325,65.246,68.29,70.723,72.649,73.717,74.174,74.414,76.151,77.158,78.273]},{"name":"Czech Republic","values":[66.87,69.03,69.9,70.38,70.29,70.71,70.96,71.58,72.4,74.01,75.51,76.486]},{"name":"Denmark","values":[70.78,71.81,72.35,72.96,73.47,74.69,74.63,74.8,75.33,76.11,77.18,78.332]},{"name":"Djibouti","values":[34.812,37.328,39.693,42.074,44.366,46.519,48.812,50.04,51.604,53.157,53.373,54.791]},{"name":"Dominican Republic","values":[45.928,49.828,53.459,56.751,59.631,61.788,63.727,66.046,68.457,69.957,70.847,72.235]},{"name":"Ecuador","values":[48.357,51.356,54.64,56.678,58.796,61.31,64.342,67.231,69.613,72.312,74.173,74.994]},{"name":"Egypt","values":[41.893,44.444,46.992,49.293,51.137,53.319,56.006,59.797,63.674,67.217,69.806,71.338]},{"name":"El Salvador","values":[45.262,48.57,52.307,55.855,58.207,56.696,56.604,63.154,66.798,69.535,70.734,71.878]},{"name":"Equatorial Guinea","values":[34.482,35.983,37.485,38.987,40.516,42.024,43.662,45.664,47.545,48.245,49.348,51.579]},{"name":"Eritrea","values":[35.928,38.047,40.158,42.189,44.142,44.535,43.89,46.453,49.991,53.378,55.24,58.04]},{"name":"Ethiopia","values":[34.078,36.667,40.059,42.115,43.515,44.51,44.916,46.684,48.091,49.402,50.725,52.947]},{"name":"Finland","values":[66.55,67.49,68.75,69.83,70.87,72.52,74.55,74.83,75.7,77.13,78.37,79.313]},{"name":"France","values":[67.41,68.93,70.51,71.55,72.38,73.83,74.89,76.34,77.46,78.64,79.59,80.657]},{"name":"Gabon","values":[37.003,38.999,40.489,44.598,48.69,52.79,56.564,60.19,61.366,60.461,56.761,56.735]},{"name":"Gambia","values":[30,32.065,33.896,35.857,38.308,41.842,45.58,49.265,52.644,55.861,58.041,59.448]},{"name":"Germany","values":[67.5,69.1,70.3,70.8,71,72.5,73.8,74.847,76.07,77.34,78.67,79.406]},{"name":"Ghana","values":[43.149,44.779,46.452,48.072,49.875,51.756,53.744,55.729,57.501,58.556,58.453,60.022]},{"name":"Greece","values":[65.86,67.86,69.51,71,72.34,73.68,75.24,76.67,77.03,77.869,78.256,79.483]},{"name":"Guatemala","values":[42.023,44.142,46.954,50.016,53.738,56.029,58.137,60.782,63.373,66.322,68.978,70.259]},{"name":"Guinea","values":[33.609,34.558,35.753,37.197,38.842,40.762,42.891,45.552,48.576,51.455,53.676,56.007]},{"name":"Guinea-Bissau","values":[32.5,33.489,34.488,35.492,36.486,37.465,39.327,41.245,43.266,44.873,45.504,46.388]},{"name":"Haiti","values":[37.579,40.696,43.59,46.243,48.042,49.923,51.461,53.636,55.089,56.671,58.137,60.916]},{"name":"Honduras","values":[41.912,44.665,48.041,50.924,53.884,57.402,60.909,64.492,66.399,67.659,68.565,70.198]},{"name":"Hong Kong, China","values":[60.96,64.75,67.65,70,72,73.6,75.45,76.2,77.601,80,81.495,82.208]},{"name":"Hungary","values":[64.03,66.41,67.96,69.5,69.76,69.95,69.39,69.58,69.17,71.04,72.59,73.338]},{"name":"Iceland","values":[72.49,73.47,73.68,73.73,74.46,76.11,76.99,77.23,78.77,78.95,80.5,81.757]},{"name":"India","values":[37.373,40.249,43.605,47.193,50.651,54.208,56.596,58.553,60.223,61.765,62.879,64.698]},{"name":"Indonesia","values":[37.468,39.918,42.518,45.964,49.203,52.702,56.159,60.137,62.681,66.041,68.588,70.65]},{"name":"Iran","values":[44.869,47.181,49.325,52.469,55.234,57.702,59.62,63.04,65.742,68.042,69.451,70.964]},{"name":"Iraq","values":[45.32,48.437,51.457,54.459,56.95,60.413,62.038,65.044,59.461,58.811,57.046,59.545]},{"name":"Ireland","values":[66.91,68.9,70.29,71.08,71.28,72.03,73.1,74.36,75.467,76.122,77.783,78.885]},{"name":"Israel","values":[65.39,67.84,69.39,70.75,71.63,73.06,74.45,75.6,76.93,78.269,79.696,80.745]},{"name":"Italy","values":[65.94,67.81,69.24,71.06,72.19,73.48,74.98,76.42,77.44,78.82,80.24,80.546]},{"name":"Jamaica","values":[58.53,62.61,65.61,67.51,69,70.11,71.21,71.77,71.766,72.262,72.047,72.567]},{"name":"Japan","values":[63.03,65.5,68.73,71.43,73.42,75.38,77.11,78.67,79.36,80.69,82,82.603]},{"name":"Jordan","values":[43.158,45.669,48.126,51.629,56.528,61.134,63.739,65.869,68.015,69.772,71.263,72.535]},{"name":"Kenya","values":[42.27,44.686,47.949,50.654,53.559,56.155,58.766,59.339,59.285,54.407,50.992,54.11]},{"name":"Korea, Dem. Rep.","values":[50.056,54.081,56.656,59.942,63.983,67.159,69.1,70.647,69.978,67.727,66.662,67.297]},{"name":"Korea, Rep.","values":[47.453,52.681,55.292,57.716,62.612,64.766,67.123,69.81,72.244,74.647,77.045,78.623]},{"name":"Kuwait","values":[55.565,58.033,60.47,64.624,67.712,69.343,71.309,74.174,75.19,76.156,76.904,77.588]},{"name":"Lebanon","values":[55.928,59.489,62.094,63.87,65.421,66.099,66.983,67.926,69.292,70.265,71.028,71.993]},{"name":"Lesotho","values":[42.138,45.047,47.747,48.492,49.767,52.208,55.078,57.18,59.685,55.558,44.593,42.592]},{"name":"Liberia","values":[38.48,39.486,40.502,41.536,42.614,43.764,44.852,46.027,40.802,42.221,43.753,45.678]},{"name":"Libya","values":[42.723,45.289,47.808,50.227,52.773,57.442,62.155,66.234,68.755,71.555,72.737,73.952]},{"name":"Madagascar","values":[36.681,38.865,40.848,42.881,44.851,46.881,48.969,49.35,52.214,54.978,57.286,59.443]},{"name":"Malawi","values":[36.256,37.207,38.41,39.487,41.766,43.767,45.642,47.457,49.42,47.495,45.009,48.303]},{"name":"Malaysia","values":[48.463,52.102,55.737,59.371,63.01,65.256,68,69.5,70.693,71.938,73.044,74.241]},{"name":"Mali","values":[33.685,35.307,36.936,38.487,39.977,41.714,43.916,46.364,48.388,49.903,51.818,54.467]},{"name":"Mauritania","values":[40.543,42.338,44.248,46.289,48.437,50.852,53.599,56.145,58.333,60.43,62.247,64.164]},{"name":"Mauritius","values":[50.986,58.089,60.246,61.557,62.944,64.93,66.711,68.74,69.745,70.736,71.954,72.801]},{"name":"Mexico","values":[50.789,55.19,58.299,60.11,62.361,65.032,67.405,69.498,71.455,73.67,74.902,76.195]},{"name":"Mongolia","values":[42.244,45.248,48.251,51.253,53.754,55.491,57.489,60.222,61.271,63.625,65.033,66.803]},{"name":"Montenegro","values":[59.164,61.448,63.728,67.178,70.636,73.066,74.101,74.865,75.435,75.445,73.981,74.543]},{"name":"Morocco","values":[42.873,45.423,47.924,50.335,52.862,55.73,59.65,62.677,65.393,67.66,69.615,71.164]},{"name":"Mozambique","values":[31.286,33.779,36.161,38.113,40.328,42.495,42.795,42.861,44.284,46.344,44.026,42.082]},{"name":"Myanmar","values":[36.319,41.905,45.108,49.379,53.07,56.059,58.056,58.339,59.32,60.328,59.908,62.069]},{"name":"Namibia","values":[41.725,45.226,48.386,51.159,53.867,56.437,58.968,60.835,61.999,58.909,51.479,52.906]},{"name":"Nepal","values":[36.157,37.686,39.393,41.472,43.971,46.748,49.594,52.537,55.727,59.426,61.34,63.785]},{"name":"Netherlands","values":[72.13,72.99,73.23,73.82,73.75,75.24,76.05,76.83,77.42,78.03,78.53,79.762]},{"name":"New Zealand","values":[69.39,70.26,71.24,71.52,71.89,72.22,73.84,74.32,76.33,77.55,79.11,80.204]},{"name":"Nicaragua","values":[42.314,45.432,48.632,51.884,55.151,57.47,59.298,62.008,65.843,68.426,70.836,72.899]},{"name":"Niger","values":[37.444,38.598,39.487,40.118,40.546,41.291,42.598,44.555,47.391,51.313,54.496,56.867]},{"name":"Nigeria","values":[36.324,37.802,39.36,41.04,42.821,44.514,45.826,46.886,47.472,47.464,46.608,46.859]},{"name":"Norway","values":[72.67,73.44,73.47,74.08,74.34,75.37,75.97,75.89,77.32,78.32,79.05,80.196]},{"name":"Oman","values":[37.578,40.08,43.165,46.988,52.143,57.367,62.728,67.734,71.197,72.499,74.193,75.64]},{"name":"Pakistan","values":[43.436,45.557,47.67,49.8,51.929,54.043,56.158,58.245,60.838,61.818,63.61,65.483]},{"name":"Panama","values":[55.191,59.201,61.817,64.071,66.216,68.681,70.472,71.523,72.462,73.738,74.712,75.537]},{"name":"Paraguay","values":[62.649,63.196,64.361,64.951,65.815,66.353,66.874,67.378,68.225,69.4,70.755,71.752]},{"name":"Peru","values":[43.902,46.263,49.096,51.445,55.448,58.447,61.406,64.134,66.458,68.386,69.906,71.421]},{"name":"Philippines","values":[47.752,51.334,54.757,56.393,58.065,60.06,62.082,64.151,66.458,68.564,70.303,71.688]},{"name":"Poland","values":[61.31,65.77,67.64,69.61,70.85,70.67,71.32,70.98,70.99,72.75,74.67,75.563]},{"name":"Portugal","values":[59.82,61.51,64.39,66.6,69.26,70.41,72.77,74.06,74.86,75.97,77.29,78.098]},{"name":"Puerto Rico","values":[64.28,68.54,69.62,71.1,72.16,73.44,73.75,74.63,73.911,74.917,77.778,78.746]},{"name":"Reunion","values":[52.724,55.09,57.666,60.542,64.274,67.064,69.885,71.913,73.615,74.772,75.744,76.442]},{"name":"Romania","values":[61.05,64.1,66.8,66.8,69.21,69.46,69.66,69.53,69.36,69.72,71.322,72.476]},{"name":"Rwanda","values":[40,41.5,43,44.1,44.6,45,46.218,44.02,23.599,36.087,43.413,46.242]},{"name":"Sao Tome and Principe","values":[46.471,48.945,51.893,54.425,56.48,58.55,60.351,61.728,62.742,63.306,64.337,65.528]},{"name":"Saudi Arabia","values":[39.875,42.868,45.914,49.901,53.886,58.69,63.012,66.295,68.768,70.533,71.626,72.777]},{"name":"Senegal","values":[37.278,39.329,41.454,43.563,45.815,48.879,52.379,55.769,58.196,60.187,61.6,63.062]},{"name":"Serbia","values":[57.996,61.685,64.531,66.914,68.7,70.3,70.162,71.218,71.659,72.232,73.213,74.002]},{"name":"Sierra Leone","values":[30.331,31.57,32.767,34.113,35.4,36.788,38.445,40.006,38.333,39.897,41.012,42.568]},{"name":"Singapore","values":[60.396,63.179,65.798,67.946,69.521,70.795,71.76,73.56,75.788,77.158,78.77,79.972]},{"name":"Slovak Republic","values":[64.36,67.45,70.33,70.98,70.35,70.45,70.8,71.08,71.38,72.71,73.8,74.663]},{"name":"Slovenia","values":[65.57,67.85,69.15,69.18,69.82,70.97,71.063,72.25,73.64,75.13,76.66,77.926]},{"name":"Somalia","values":[32.978,34.977,36.981,38.977,40.973,41.974,42.955,44.501,39.658,43.795,45.936,48.159]},{"name":"South Africa","values":[45.009,47.985,49.951,51.927,53.696,55.527,58.161,60.834,61.888,60.236,53.365,49.339]},{"name":"Spain","values":[64.94,66.66,69.69,71.44,73.06,74.39,76.3,76.9,77.57,78.77,79.78,80.941]},{"name":"Sri Lanka","values":[57.593,61.456,62.192,64.266,65.042,65.949,68.757,69.011,70.379,70.457,70.815,72.396]},{"name":"Sudan","values":[38.635,39.624,40.87,42.858,45.083,47.8,50.338,51.744,53.556,55.373,56.369,58.556]},{"name":"Swaziland","values":[41.407,43.424,44.992,46.633,49.552,52.537,55.561,57.678,58.474,54.289,43.869,39.613]},{"name":"Sweden","values":[71.86,72.49,73.37,74.16,74.72,75.44,76.42,77.19,78.16,79.39,80.04,80.884]},{"name":"Switzerland","values":[69.62,70.56,71.32,72.77,73.78,75.39,76.21,77.41,78.03,79.37,80.62,81.701]},{"name":"Syria","values":[45.883,48.284,50.305,53.655,57.296,61.195,64.59,66.974,69.249,71.527,73.053,74.143]},{"name":"Taiwan","values":[58.5,62.4,65.2,67.5,69.39,70.59,72.16,73.4,74.26,75.25,76.99,78.4]},{"name":"Tanzania","values":[41.215,42.974,44.246,45.757,47.62,49.919,50.608,51.535,50.44,48.466,49.651,52.517]},{"name":"Thailand","values":[50.848,53.63,56.061,58.285,60.405,62.494,64.597,66.084,67.298,67.521,68.564,70.616]},{"name":"Togo","values":[38.596,41.208,43.922,46.769,49.759,52.887,55.471,56.941,58.061,58.39,57.561,58.42]},{"name":"Trinidad and Tobago","values":[59.1,61.8,64.9,65.4,65.9,68.3,68.832,69.582,69.862,69.465,68.976,69.819]},{"name":"Tunisia","values":[44.6,47.1,49.579,52.053,55.602,59.837,64.048,66.894,70.001,71.973,73.042,73.923]},{"name":"Turkey","values":[43.585,48.079,52.098,54.336,57.005,59.507,61.036,63.108,66.146,68.835,70.845,71.777]},{"name":"Uganda","values":[39.978,42.571,45.344,48.051,51.016,50.35,49.849,51.509,48.825,44.578,47.813,51.542]},{"name":"United Kingdom","values":[69.18,70.42,70.76,71.36,72.01,72.76,74.04,75.007,76.42,77.218,78.471,79.425]},{"name":"United States","values":[68.44,69.49,70.21,70.76,71.34,73.38,74.65,75.02,76.09,76.81,77.31,78.242]},{"name":"Uruguay","values":[66.071,67.044,68.253,68.468,68.673,69.481,70.805,71.918,72.752,74.223,75.307,76.384]},{"name":"Venezuela","values":[55.088,57.907,60.77,63.479,65.712,67.456,68.557,70.19,71.15,72.146,72.766,73.747]},{"name":"Vietnam","values":[40.412,42.887,45.363,47.838,50.254,55.764,58.816,62.82,67.662,70.672,73.017,74.249]},{"name":"West Bank and Gaza","values":[43.16,45.671,48.127,51.631,56.532,60.765,64.406,67.046,69.718,71.096,72.37,73.422]},{"name":"Yemen, Rep.","values":[32.548,33.97,35.18,36.984,39.848,44.175,49.113,52.922,55.599,58.02,60.308,62.698]},{"name":"Zambia","values":[42.038,44.077,46.023,47.768,50.107,51.386,51.821,50.821,46.1,40.238,39.193,42.384]},{"name":"Zimbabwe","values":[48.451,50.469,52.358,53.995,55.635,57.674,60.363,62.351,60.377,46.809,39.989,43.487]}],"dates":[-545616000000,-387849600000,-230083200000,-72316800000,85536000000,243302400000,401068800000,558835200000,716688000000,874454400000,1032220800000,1189987200000]}},"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script>
</div>
<div id="size-the-widget" class="section level2">
<h2 class="hasAnchor">
<a href="#size-the-widget" class="anchor"></a>Size the widget</h2>
<p>Widget sizing is a bit complicated as it depends on several factors :</p>
<ul>
<li>the size of the HTML widget himself.</li>
<li>the size of the outputs of the cells embedded in the widget.</li>
<li>the value of the <code>height</code> cell value, if it exists.</li>
<li>the value of the <code>width</code> cell value, if it exists. If not, <code>width</code> by default is defined by the <a href="https://github.com/observablehq/stdlib#width">Observable standard library</a> as the page width.</li>
</ul>
<p>By default, <code>robservable</code> overrides the potential <code>width</code> and <code>height</code> notebook values by the <code>htmlwidget</code> container <code>HTML</code> element width and height. This override is performed both at widget creation and on widget resizing. Overriding <code>width</code> allows making the widget “fit” in its container, and avoids updating size when the page is resized but not its container (which is the case when <code>width</code> is taken from Observable standard library). Overriding <code>height</code> has the same purpose, but not all notebooks define a <code>height</code> value, so unlike <code>width</code>, <code>height</code> won’t always have an effect.</p>
<p>This value override allows the following figure to fit in the widget dimensions.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@mbostock/eyes"</span>,
  include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"canvas"</span>, <span class="st">"mouse"</span><span class="op">)</span>,
  hide <span class="op">=</span> <span class="st">"mouse"</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-4fd01ae2ebc833a88548" style="width:700px;height:432.632880098888px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-4fd01ae2ebc833a88548">{"x":{"notebook":"@mbostock/eyes","include":["canvas","mouse"],"hide":"mouse","input":null,"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p>If you explicitly specify the <code>width</code> and <code>height</code> of the widget with the corresponding arguments, the cell values will be updated accordingly.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@mbostock/eyes"</span>,
  include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"canvas"</span>, <span class="st">"mouse"</span><span class="op">)</span>,
  hide <span class="op">=</span> <span class="st">"mouse"</span>,
  width <span class="op">=</span> <span class="fl">500</span>,
  height <span class="op">=</span> <span class="fl">100</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-ad629e174dd08ec3b47d" style="width:500px;height:100px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-ad629e174dd08ec3b47d">{"x":{"notebook":"@mbostock/eyes","include":["canvas","mouse"],"hide":"mouse","input":null,"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p>If the notebook doesn’t provide a <code>height</code> value, then you’ll have to manually define an height suitable for the output.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@d3/bivariate-choropleth"</span>,
  include <span class="op">=</span> <span class="st">"chart"</span>,
  height <span class="op">=</span> <span class="fl">450</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-282e48dbbaf7670be5c7" style="width:700px;height:450px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-282e48dbbaf7670be5c7">{"x":{"notebook":"@d3/bivariate-choropleth","include":"chart","hide":null,"input":null,"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p>Finally, if you provide both a widget <code>height</code> and an <code>height</code> value with the <code>input</code> argument, the second one is not overriden.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@mbostock/eyes"</span>,
  include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"canvas"</span>, <span class="st">"mouse"</span><span class="op">)</span>,
  hide <span class="op">=</span> <span class="st">"mouse"</span>,
  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,
  height <span class="op">=</span> <span class="fl">200</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-e2021da74095576c9cc0" style="width:700px;height:200px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-e2021da74095576c9cc0">{"x":{"notebook":"@mbostock/eyes","include":["canvas","mouse"],"hide":"mouse","input":{"height":50},"input_js":[],"observers":null,"update_height":true,"update_width":true},"evals":[],"jsHooks":[]}</script><p>There are some cases when these <code>width</code> and <code>height</code> overrides are not suitable. First, those values could be defined for something else than an output size (<code>height</code> could be another type of parameter). Second, overriding the height can modify the chart appearance. In these cases, you can set the <code>update_width</code> or <code>update_height</code> arguments to <code>FALSE</code> to deactivate the value override.</p>
<p>For example, on our horizontal bar chart, it changes the original bar heights. To avoid this effect, we can deactivate <code>height</code> override with the <code>update_height = FALSE</code> argument.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">species</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"value"</span><span class="op">)</span>

<span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span>
  <span class="st">"@d3/horizontal-bar-chart"</span>,
  include  <span class="op">=</span> <span class="st">"chart"</span>,
  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">df</span>,
    margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>top <span class="op">=</span> <span class="fl">20</span>, right <span class="op">=</span> <span class="fl">0</span>, left <span class="op">=</span> <span class="fl">70</span>, bottom <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span>,
  update_height <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<div id="htmlwidget-53aff9b691f3e4c4d6b9" style="width:700px;height:432.632880098888px;" class="robservable html-widget"></div>
<script type="application/json" data-for="htmlwidget-53aff9b691f3e4c4d6b9">{"x":{"notebook":"@d3/horizontal-bar-chart","include":"chart","hide":null,"input":{"data":[{"name":"Adelie","value":152},{"name":"Chinstrap","value":68},{"name":"Gentoo","value":124}],"margin":{"top":20,"right":0,"left":70,"bottom":0}},"input_js":[],"observers":null,"update_height":false,"update_width":true},"evals":[],"jsHooks":[]}</script>
</div>
<div id="write-notebooks-for-robservable" class="section level2">
<h2 class="hasAnchor">
<a href="#write-notebooks-for-robservable" class="anchor"></a>Write notebooks for robservable</h2>
<p>If you are developing Observable notebooks to be used with robservable, here is some advice to make your notebook easier to use in R:</p>
<ul>
<li>you could see your notebook as a function. Most cells are input arguments, and others are output with results.</li>
<li>to allow the output to be customized in R, move as many settings and values as possible in their own cell.</li>
<li>name all the cells that could be included or whose value could be modified in R.</li>
<li>give a name to the CSS <code>&lt;style&gt;</code> cells, this will greatly ease their inclusion.</li>
<li>making your chart updatable with animated transitions can be a nice addition if the notebook could be used in a shiny app. See the <a href="https://juba.github.io/robservable/articles/shiny.html#animated-transitions-1">robservable in Shiny applications vignette</a> for a bit more information on this.</li>
</ul>
</div>
<div id="advanced-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-usage" class="anchor"></a>Advanced usage</h2>
<div id="inspector-state-events" class="section level3">
<h3 class="hasAnchor">
<a href="#inspector-state-events" class="anchor"></a>Inspector state events</h3>
<p>In Observable, <a href="https://github.com/observablehq/runtime#observers">a cell can be in three states</a> : <code>pending</code>, <code>fulfilled</code> or <code>rejected</code>. For each included named cell, <code>robservable</code> emits custom JavaScript events which allow to track the cell state.</p>
<p>For example, suppose you include a <code>chart</code> cell from a notebook. You can then listen to the following <code>document</code> custom events :</p>
<ul>
<li>
<code>robservable-chart-pending</code> : when the <code>chart</code> cell is in pending state</li>
<li>
<code>robservable-chart-fulfilled</code> : when the <code>chart</code> cell is in fulfilled state</li>
<li>
<code>robservable-chart-rejected</code> : when the <code>chart</code> cell is in rejected state</li>
</ul>
<p>Here is a sample use case : suppose you are including a notebook cell which generates a chart inside an Rmarkdown document or Shiny app, and you want to add a custom interaction when hovering certain charts elements. For this to work, you have to wait for the cell to be rendered, so that you can add event listeners. This is possible with something like the following code :</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1"></a><span class="va">document</span>.<span class="at">addEventListener</span>(<span class="st">"robservable-chart-fulfilled"</span><span class="op">,</span> (event) <span class="kw">=&gt;</span> <span class="op">{</span>         </span>
<span id="cb19-2"><a href="#cb19-2"></a>   <span class="va">d3</span>.<span class="at">selectAll</span>(<span class="st">"#chart rect"</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a>    .<span class="at">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> (event) <span class="kw">=&gt;</span> <span class="op">{</span> ... <span class="op">}</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>    .<span class="at">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> (event) <span class="kw">=&gt;</span> <span class="op">{</span> ... <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="op">},</span> <span class="kw">false</span>)</span></code></pre></div>
<script type="text/javascript">
document.addEventListener("robservable-chart-fulfilled", (event) => {         
   d3.selectAll("#chart rect")
    .on("mouseover", (event) => { ... })
    .on("mouseout", (event) => { ... });
}, false)
</script>
</div>
<div id="updating-a-cell-javascript-code" class="section level3">
<h3 class="hasAnchor">
<a href="#updating-a-cell-javascript-code" class="anchor"></a>Updating a cell JavaScript code</h3>
<p>The examples above show how to update a cell with a “fixed” value : a string, a number, a data frame… But sometimes you need to redefine a cell as JavaScript code, for example to redefine a function.</p>
<p>Suppose in our Observable notebook we have the following cell :</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1"></a>func <span class="op">=</span> x <span class="kw">=&gt;</span> (x <span class="op">+</span> <span class="dv">2</span>)</span></code></pre></div>
<p>If we want to redefine this function using the JavaScript Observable runtime API, following the <a href="https://github.com/observablehq/runtime#variable_define">variable.define documentation</a> we would use something like :</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1"></a><span class="va">module</span>.<span class="at">redefine</span>(<span class="st">"func"</span><span class="op">,</span> []<span class="op">,</span> () <span class="kw">=&gt;</span> x <span class="kw">=&gt;</span> (x <span class="op">+</span> <span class="dv">10</span>))</span></code></pre></div>
<p>To do this in <code>robservable</code>, use the <code>input_js</code> argument. This is a named list whose elements are also lists with <code>inputs</code> and <code>definition</code> entries. In this case the syntax would be :</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span><span class="va">...</span>,
  input_js <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>inputs <span class="op">=</span> <span class="cn">NULL</span>, definition <span class="op">=</span> <span class="st">"() =&gt; (x) =&gt; (x + 10)"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>In a slightly more complex case, maybe our initial function is the following, when <code>param</code> is not an argument of our function but the value of another notebook cell :</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1"></a>func <span class="op">=</span> x <span class="kw">=&gt;</span> (x <span class="op">+</span> param)</span></code></pre></div>
<p>If we want to redefine this function while still accessing the <code>param</code> cell value, we have to add its name to the <code>inputs</code> entry of <code>input_js</code> :</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/robservable.html">robservable</a></span><span class="op">(</span><span class="va">...</span>,
  input_js <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>inputs <span class="op">=</span> <span class="st">"param"</span>, definition <span class="op">=</span> <span class="st">"(param) =&gt; (x) =&gt; (x - param)"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>For more details on the usage of <code>inputs</code> and <code>definition</code>, see the <a href="https://github.com/observablehq/runtime#variable_define">Observable runtime API documentation</a>.</p>
</div>
<div id="customizing-json-serialization" class="section level3">
<h3 class="hasAnchor">
<a href="#customizing-json-serialization" class="anchor"></a>Customizing JSON serialization</h3>
<p>By default <code>robservable</code> uses <code>htmlwidgets</code> for JSON serialization of the widgets arguments, with an additional <code>TOJSON_ARGS</code> value of <code><a href="https://rdrr.io/r/base/list.html">list(dataframe = "rows")</a></code> so that R data frames are converted to a format suitable for <code>d3</code>.</p>
<p>You can change the value of <code>TOJSON_ARGS</code> with the <code>json_args</code> argument of <code>robservable</code>, or you can pass a custom JSON serializing R function with the <code>json_func</code> argument. This function will be passed to <code>htmlwidgets</code> via its internal <code>TOJSON_FUNC</code> parameter. See the <a href="https://www.htmlwidgets.org/develop_advanced.html#custom-json-serializer">custom JSON serializer documentation</a> for more details.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The result is not displayed here as a whole notebook is not very suitable for embedding in a document<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Another option for unnamed cells is to fork the notebook in Observable and to add a name yourself.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Julien Barnier, Kenton Russell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
